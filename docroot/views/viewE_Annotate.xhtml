<!DOCTYPE html>
<f:view lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui"
	xmlns:of="http://omnifaces.org/functions">
	<h:body>
		<ui:remove> <!-- *****************  style and script ************************* --> </ui:remove>
		<style>
			.title {
				font-size: 12px;
				font-weight: bold;
				font-family: Calibri;
			}
			
			.dataValue {
				font-size: 12px;
				font-weight: normal;
				font-family: arial, sans-serif;
			}
		</style>
		<!-- 		knalb tfel yllanoitnetni egap siht \_|_/ this page intentionally left blank  -->
		<h:form id="formManualAnnotation">
			<p:remoteCommand name="calledOnLoad"
				oncomplete="renderSingleGraphFineTuner('#{annotationBacking.dataSX}', #{annotationBacking.showFineGraph}, '#{annotationBacking.termName}');" autoRun="true" />

			<p:remoteCommand name="lookupAnnotationParam" partialSubmit="true"
				update="ontologyTermName ontologyDefinition"
				action="#{annotationBacking.lookupDefinition}"/>
			<p:remoteCommand name="updateAnnotationIntervalEdit"
				action="#{annotationBacking.viewAnnotationInterval}" />
				
				
					
			<p:panelGrid id="AnnotationSetter" layout="block" columns="2"
				frame="none" border="5" cellpadding="0" cellspacing="0" >

				<ui:remove> <!-- *****************  Left Panel, Ontology Tree ************************* --> </ui:remove>
				<p:panel id="panelLeft" header="Bioportal"
					style="background-color:#d0e4f6; padding:20 0; height:360px; width:370px">
					<p:media player="flash" id="OntologyTree" 
						value="http://keg.cs.uvic.ca/ncbo/ontologytree/OntologyTree.swf?"
						width="350" height="300">
						<f:param name="id" value="OntologyTree" />
						<f:param name="allowScriptAccess" value="always" />
						<f:param name="flashVars"
							value="ontology=2079&amp;alerterrors=false&amp;canchangeontology=true&amp;virtual=true" />
					</p:media>
				</p:panel>

				<ui:remove> <!-- *****************  Right Panel, Graph onclick data: ECG attributes & Selected points & Term Selection/manual comments ************************* --> </ui:remove>
				<h:panelGroup id="panelRightContainer" >
					<p:panel id="panelRight" header="Annotation"
							rendered="#{not annotationBacking.showFineGraph}"
							style="background-color:#d0e4f6; top:0; padding:0 0; height:360px; width:600px;" >
						
						<ui:remove> <!-- *****************  Right Panel, Upper section: ECG attributes ************************* --> </ui:remove>
						<h:panelGrid id="GraphClickData" columns="2" frame="none"
							border="0" cellpadding="0" cellspacing="0" styleClass="title"
							style="background: whiteSmoke; vertical-align:text-top;">
	
							<ui:remove> <!-- *****************  Right Panel, Upper left section: ECG attributes ************************* --> </ui:remove>
							<h:panelGrid id="ECG_Attributes" columns="2" frame="none"
								style="background: whiteSmoke;">
								<h:outputLabel value="Subject ID" />
								<h:outputLabel value="#{annotationBacking.studyEntry.recordName}"
									styleClass="dataValue" />
	
								<h:outputLabel value="Lead" />
								<h:outputLabel value="#{annotationBacking.leadName}"
									styleClass="dataValue" />
	
								<h:outputLabel value="Rate" />
								<h:outputLabel
									value="#{annotationBacking.studyEntry.samplingRate}Hz"
									styleClass="dataValue" />
	
								<h:outputLabel value="Annotations" />
								<h:outputLabel value="#{annotationBacking.annotationCount}"
									styleClass="dataValue" />
							</h:panelGrid>
	
	
							<ui:remove> <!-- *****************  Right Panel, Upper right Section: Selected points ************************* --> </ui:remove>
							<h:panelGrid id="SelectedPoints"
								columns="#{annotationBacking.singlePoint? '2' : '4'}"
								frame="none" cellpadding="0" cellspacing="0" styleClass="title"
								style="background: whiteSmoke; top:0; ">
	
								<h:outputLabel value="" style="width:140px;" />
								<h:outputLabel value="Onset" styleClass="title"
									style="width:100px" />
								<h:outputLabel value="Offset" styleClass="title"
									style="width:100px" rendered="#{!annotationBacking.singlePoint}" />
								<h:outputLabel value="Change" styleClass="title"
									style="width:100px" rendered="#{!annotationBacking.singlePoint}" />
	
								<h:outputLabel value="Time(mSec)" styleClass="title" />
								<h:panelGroup id="dataSYHolder2" layout="block">
									<h:outputText id="dataSX" styleClass="dataValue"
										value="#{annotationBacking.dataSX}" />
								</h:panelGroup>
								<h:panelGroup id="dataEXHolder2" layout="block"
									rendered="#{!annotationBacking.singlePoint}">
									<h:outputText id="dataSXDuration" styleClass="dataValue"
										value="#{annotationBacking.dataOffsetX}" />
								</h:panelGroup>
								<h:panelGroup id="dataEYHolder" layout="block"
									rendered="#{!annotationBacking.singlePoint}">
									<h:outputText id="dataSXDuration2" styleClass="dataValue"
										value="#{annotationBacking.dataSXDuration}" />
								</h:panelGroup>
	
								<h:outputLabel value="Amplitude(Î¼V)" styleClass="title" />
								<h:panelGroup id="dataSXHolder2" layout="block">
									<h:outputText id="dataSY" styleClass="dataValue"
										value="#{annotationBacking.dataSY}" />
								</h:panelGroup>
								<h:panelGroup id="dataSXHolderDuration" layout="block"
									rendered="#{!annotationBacking.singlePoint}">
									<h:outputText id="dataSYDuration" styleClass="dataValue"
										value="#{annotationBacking.dataOffsetY}" />
								</h:panelGroup>
								<h:panelGroup id="dataSXHolderDuration2" layout="block"
									rendered="#{!annotationBacking.singlePoint}">
									<h:outputText id="dataSYDuration2" styleClass="dataValue"
										value="#{annotationBacking.dataSYDuration}" />
								</h:panelGroup>
	
								<h:outputLabel value="Adjust" styleClass="title" />
								<p:commandButton value="Chg" style="height:80%"
									title="Fine tune the selected onset time." 
									actionListener="#{annotationBacking.showNewAnnotationGraph}"
									update="panelRightContainer"
									oncomplete="fineTuningPoint=0;
										renderSingleGraphFineTuner('#{annotationBacking.dataSX}', 
																	true, 
																	'#{annotationBacking.termName}');"/>
								<p:commandButton value="Chg"
									title="Fine tune the selected Offset time."
									rendered="#{!annotationBacking.singlePoint}"
									actionListener="#{annotationBacking.showNewAnnotationGraph}"
									update="panelRightContainer"
									oncomplete="fineTuningPoint=1;
										renderSingleGraphFineTuner('#{annotationBacking.dataOffsetX}', 
																	true, 
																	'#{annotationBacking.termName}');"/>
								<p:commandButton value="All"
									title="View the entire interval."
									rendered="#{!annotationBacking.singlePoint}"
									actionListener="#{annotationBacking.showNewAnnotationGraph}"
									update="panelRightContainer"
									oncomplete="fineTuningPoint=-1;
										renderSingleGraphFullAnnotation('#{annotationBacking.dataSX}',
																		'#{annotationBacking.dataOffsetX}',
																		true);"/>
							</h:panelGrid>
						</h:panelGrid>
						<ui:remove> <!-- *****************  Right Panel, Lower Section: Term Selection/manual comments ************************* --> </ui:remove>
						<h:panelGrid id="termSelection" 
							columns="2"
							style="background: whiteSmoke; border: 1px solid red; width:525px;">
	
							<h:outputLabel for="nodeIDName" value="*" rendered="false" />
							<h:outputText id="nodeIDDOM" class="nodeIDsendDOM"
								value="#{annotationBacking.nodeID}" rendered="false" />
	
							<h:outputLabel value="" />
							<h:outputLabel styleClass="title"
								value="Find the term in the bioportal ontology tree." />
	
							<h:outputLabel for="ontologyTermName" styleClass="title"
								value="Term:" />
							<h:outputText id="ontologyTermName" styleClass="dataValue"
								value="#{annotationBacking.termName}" required="true" />
	
							<h:outputLabel for="ontologyDefinition" styleClass="title"
								value="Definition" />
							<h:outputText id="ontologyDefinition" styleClass="dataValue"
								value="#{annotationBacking.fullAnnotation}" />
	
							<h:outputLabel for="manualComment" styleClass="title"
								value="Comment" />
							<h:inputTextarea id="manualComment" styleClass="dataValue"
								rows="4" style="border: 1px solid blue;width:100%"
								value="#{annotationBacking.comment}" />
						</h:panelGrid>
					</p:panel>
	
					<ui:remove> <!-- *****************  Alternate Right Panel, Fine tune Graph   graphContainer- height:350px;************************* --> </ui:remove>
					<p:panel id="panelRightAlternate" header="Annotation Fine Tuning"				
						 	rendered="#{annotationBacking.showFineGraph}"
							style="background-color:#d0e4f6; top:0; padding:0 0; height:'100%';  width:'600px';">
	
						<h:panelGrid id="graphContainer" columns="1" border="0" width="100%" 
								style="background-color:#d0f6d0; top:0; padding:0 0;">
							<h:panelGroup id="fineTune_div" layout="block" class="graph" 
								style="border:2; ">
								GRAPH WILL GO HERE
								<h:graphicImage value="/image/graph-loader.gif"
									title="graph loading indicator" alt="graph loading indicator" />
							</h:panelGroup>
		
							<h:panelGroup id="status_div" layout="block" style="height:20px;">
								Mouse over graph to see data details.
							</h:panelGroup>
		
							<h:panelGroup id="editButton_div" layout="block" style="align:right">
									<p:commandButton value="Update" 
										title="Save the newly selected point." 
										rendered="#{not annotationBacking.previousAnnotation}"
										actionListener="#{annotationBacking.showNewAnnotationDetails}"
										update="panelRightContainer"
										oncomplete="updateFineTuning();"/>
									<p:commandButton value="Discard"
										title="Discard the newly selected point and restore the previous point."
										rendered="#{not annotationBacking.previousAnnotation}"
										actionListener="#{annotationBacking.showNewAnnotationDetails}"
										update="panelRightContainer"
										oncomplete="fineTuningPoint=-1;updateFineTuning();" />
									<p:commandButton value="Close Graph"
										title="Close the graph and show the numbers chart."
										actionListener="#{annotationBacking.showNewAnnotationDetails}"
										update="panelRightContainer"
										oncomplete="fineTuningPoint=-1;updateFineTuning();" />
							</h:panelGroup>
						</h:panelGrid>				
					</p:panel>
				</h:panelGroup>				
				<ui:remove> <!-- *****************  Left Panel Row 2, tree reseting buttons ************************* --> </ui:remove>
				<h:panelGroup id="treeButtons" layout="block" style="align:right">
					<p:commandButton value="ECG Ontology"
						title="Show the points and intervals branches of the ECG ontology."  
						oncomplete="loadOntology(42932);"/>

					<p:commandButton value="ECG Intervals Ontology"
						title="Show only the intervals branch of the ECG ontology." 
						oncomplete="loadOntology(48037);" />
				</h:panelGroup>
				
				<ui:remove> <!-- *****************  Right Panel Row 2, Buttons ************************* --> </ui:remove>
				<h:panelGroup id="buttons" layout="block" style="align:right">
					<p:commandButton value="Save"
						disabled="#{annotationBacking.previousAnnotation}"
						actionListener="#{annotationBacking.saveAnnotationSetFlag}"
						action="#{annotationBacking.viewSingleGraph}" 
						oncomplete="handleComplete(xhr, status, args)" />

					<p:commandButton value="Cancel"
						action="#{annotationBacking.viewSingleGraph}"
						title="Close manual annotation panel without saving." />
				</h:panelGroup>

			</p:panelGrid>
		</h:form>
	</h:body>
</f:view>