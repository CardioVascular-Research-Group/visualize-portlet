<?xml version="1.0"?>

<f:view
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">
	<h:head />
	<h:body>
		<f:event type="preRenderView" listener="#{annotationBacking.initialize}" />
		<h:form id="drawGraph_loadAnnotations">
			<p:remoteCommand name="calledOnLoad"
				oncomplete="renderGraphAndAnnotations();"
				autoRun="true">
			</p:remoteCommand>
		</h:form>
		<h:form>
			<p:remoteCommand name="viewAnnotationPointEdit" 
            				action="#{annotationBacking.viewAnnotationPoint}"/>

			<p:remoteCommand name="viewAnnotationIntervalEdit" 
            				action="#{annotationBacking.viewAnnotationInterval}"/>

			<p:remoteCommand name="viewCurrentAnnotationNoEdit"
				partialSubmit="false"
				action="#{annotationBacking.viewCurrentAnnotation}" />
		</h:form>
		<script>
			var renderGraphAndAnnotations = function(){
				//alert("renderGraphAndAnnotations() called.");
				var namespace = '#{facesContext.externalContext.encodeNamespace('')}';
				CVRG_drawECGgraphSingle('ecgSingle_div', namespace);
				WAVEFORM_ShowAnnotationSingle();
				WAVEFORM_showHighLight();
			}
		</script>

		<h:panelGroup id="backgroundofContentDiv" layout="block" styleClass="backgroundofContent">
			<p:layout id="graphView"
				style=" min-height:710px; height:720px; top:20px">
				<p:layoutUnit id="ecgGraphLayout" 
								position="center"
								style="min-width:400px; 
									min-height:700px; 
									width:90%; 
									background-color:#fdf6e3; 
									margin:1px auto;">
					<p:panel id="graphContainerDiv" styleClass="ecgContainer">
						<!-- START LEAD VISULAZATION  -->
							<h:inputHidden id="voltMinInput" value="1" immediate="true" />
							<h:inputHidden id="voltMaxInput" value="100" immediate="true" />
							<h:inputHidden id="voltCenterInput" value="0" immediate="true" />

						<h:panelGrid columns="2" border="0">
							<h:outputText value=""/>
							<h:outputText id="TitleDiv0" 
								value="#{annotationBacking.leadDescription}"
								styleClass="title"/>		
			
							<p:slider id="sliderVoltCenterSingle" for="#{facesContext.externalContext.encodeNamespace(':voltCenterInput')}"
									type="vertical" 
									style="height:400px" 
									minValue="-50" 
									maxValue="50"
									onSlideEnd="zoomVoltage()" />
							<h:panelGroup id="ecgSingle_div" layout="block" class="graph" style="border:1">
								GRAPH WILL GO HERE
							</h:panelGroup>		
											
							<h:outputText value=""/>
							<h:panelGroup id="status_div" layout="block" style="height:20px;">
								Mouse over graph to see data details.
							</h:panelGroup>
						</h:panelGrid>
						
						<p:button id="voltCenterButton" value="center" type="button"
								onclick="centerVoltage();return false;"></p:button>
						<p:button id="voltCenterNScaleButton" value="center and scale" type="button"
								onclick="centerScaleVoltage();return false;"></p:button>
						<p:button id="voltResetButton" value="reset" type="button"
								onclick="setVoltageZoom(-2000,2000);return false;"></p:button>
						
						<h:panelGroup id="list_div" layout="block"></h:panelGroup>
				 	</p:panel>	
				</p:layoutUnit>
				
 				<p:layoutUnit id="viewChangeButtons" position="east" resizable="true" size="150"
					minSize="50" maxSize="550">
					<ui:include src="include/includeViewChangeButtons.xhtml" />
					<ui:include src="include/includePanZoom.xhtml" />
					<ui:include src="include/includeAnnotate.xhtml" />
				</p:layoutUnit>
			</p:layout>
		</h:panelGroup>

	</h:body>
</f:view>
