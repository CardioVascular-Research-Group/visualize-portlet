
<ui:composition lang="en" xmlns="http://www.w3.org/1999/xhtml"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<!-- START OF TOP include_viewContentLeads -->
	<!-- MOVE TO CSS -->
	<style>
.hoverShadow:hover {
	border-radius: 5px;
	box-shadow: 0 5px 10px rgba(80, 0, 0, .3);
}
</style>
	<!-- MOVE TO CSS -->
	<h:panelGroup layout="block" styleClass="backgroundofContent">
		<p:layout id="viewLayout"
			style=" min-height:710px; height:720px; top:20px">
			<p:layoutUnit id="ecgGraphLayout" 
				position="center"
				style="min-width:400px; 
					min-height:700px; 
					width:90%; 
					background-color:#fdf6e3; 
					margin:1px auto;">
				<!-- START TEMP FOR TESTING ONLY the JavaScript display none; -->
				<h:outputScript>
<!--			        length=length-->
			        <!--  b2=bZ.length  -->
				</h:outputScript>
				<!--  START to carry the Java import of ECG data by calling the methed onload -->
				<!--
				<h:form>
					 Button Used to create the Ajax Display = None 
					<h:commandButton value="submit" onclick="WAVEFORM_showGraphs()"
						style="display:none;">
						<f:ajax />
					</h:commandButton>
				</h:form>
				-->
				
				<!-- END TEMP FOR TESTING ONLY the JavaScript  -->
				<!-- Sends a call to the server to retreve the data for dygraphic to render -->
				<!-- START DEV: Show uploaded data string hidden fore texting -->
				<div id="show12LeadData"
					style="display: none; 
						height: 100px; 
						width: 600px; 
						left: 400px; 
						position: absolute; 
						background-color: #ccc; 
						color: black;">
				</div>
				<!-- END DEV: Show uploaded data string hidden fore texting -->
				
				<f:verbatim>
					<script>
						//var OmniFaces=OmniFaces;
						var dataFull;
						//var isSingleLead=false; // determines which graph refresh function to call after a pan or zoom.
						var WF_minTime = 1, WF_maxTime = 5000;
						function show12LeadData(minTime, maxTime, ECG) {
							var namespace = '#{facesContext.externalContext.encodeNamespace('')}';
							WF_minTime = minTime;
							WF_maxTime = maxTime;
							dataFull = ""; // clear data variable.
							var $show12LeadDataVar = $("#show12LeadData"); // A) Used to Show the data arrive on the screen 
							//alert("running show12LeadData() in include_viewContentLayout.xhtml minTime:" + WF_minTime );
							//alert("running show12LeadData() in include_viewContentLayout.xhtml maxTime:" + WF_maxTime );
							//$.each(data12lead, function(key, value) {
								//alert(key + "=" + JSON.stringify(value));
								// used to see the data arrive into the View 
								//$("&lt;div&gt;").text(i + "=" + JSON.stringify(labels[i])).appendTo($show12LeadDataVar)); // A) JSON.stringify(value)).appendTo($show12LeadDataVar); A Used to Show the data arrive on the screen 						
								// SeTting the ValUe to "data" the Variable that fills the Graph
								dataFull = WAVEFORM_parseCSV(ECG, namespace);
								// Turning on the Dygrahs Display
							//});
							WAVEFORM_showGraphs(namespace);
							WAVEFORM_zoomGraphX(minTime, maxTime); // Changes the dataWindow on all 12 leads.
							// WAVEFORM_backfillDataArray(dataFull);
							WAVEFORM_replaceDataArray(dataFull);
						}
		
						// This function is kept on the .xhtml page, because it contains code specific to this layout. 
		                var WAVEFORM_showGraphs = function(namespace){
		                    //alert("running WAVEFORM_showGraphs() in include_12Lead_DIV.xhtml data.length:" + dataFull.length);
		                    populate12Graphs(2500, dataFull, namespace); 
		                    makeCalibrationMarks(4, namespace);
		                }
		            </script>
				</f:verbatim>
				<!--
				<h:panelGroup id="navDivFormat" layout="block">
					<ui:include src="/views/12Lead_DIV.xhtml" />
				</h:panelGroup>
				-->
				<ui:fragment id="panelMultipleGraph" autoUpdate="true" rendered="#{visualizeBacking.graphMultipleVisible}">
					<!-- <h:outputText value="namespace=#{facesContext.externalContext.encodeNamespace('')}" /> -->
					<ui:include src="12Lead_DIV.xhtml" />					
					<script>
						var data = '#{visualizeBacking.data}';
						var dataJsonParse = JSON.parse(data);
						show12LeadData(dataJsonParse.minTime, dataJsonParse.maxTime, dataJsonParse.ECG);
					</script>
					<!-- <h:outputText value="#{visualizeBacking.data}" />  -->			
				</ui:fragment>
				
				<ui:fragment id="panelSingleGraph" autoUpdate="true" rendered="#{!(visualizeBacking.graphMultipleVisible)}">
			    	<ui:include src="singleLeadFragment.xhtml" />
				</ui:fragment>
				
			</p:layoutUnit>

			<p:layoutUnit id="viewChangeButtons" position="east" resizable="true" size="550"
				minSize="50" maxSize="550">

				<ui:include src="include/viewChangeButtons.xhtml" />
			</p:layoutUnit>
		</p:layout>
	</h:panelGroup>
</ui:composition>